<!--회원가입 페이지-->
<!--signup.html-->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="/css/bootstrap.min.css" integrity="sha384-
ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          crossorigin="anonymous">
    <link href="/css/moviereco-basic.css" rel="stylesheet">
</head>
<nav th:replace="common :: menu"></nav>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<div class = "movie-layer">
    <span class="movie-wrapper">
        <form role="form" action="/signup" th:object="${memberDetail}" method="post">
            나이 : <input type="text" th:field="*{birthDate}" name="birthDate"/> <br/><br/>
            성별:  <input type="text" th:field="*{gender}" name="gender"/><br/><br/>
            email : <input type="email" th:field="*{email}" name="email" id="email"/>&nbsp<button type="button" id="checkemail">이메일중복확인</button><br/><br/>
            password : <input type="password" th:field="*{password}"  name="password"/><br/><br/>
            <button type="submit" id="joinuser" disabled>회원가입</button>
            <input type="hidden"
                   th:name="${_csrf.parameterName}"
                   th:value="${_csrf.token}" />
        </form>
    </span>
</div>
<!-- 사용자 스크립트 추가 -->
<th:block layout:fragment="script">
<script th:inline="javascript">
$(function () {
    $('#checkemail').on('click', function () {
        alert("중복체크");
        var email = $('#email').val();

        $.ajax({
                           type: 'GET',
                           url: '/signup/checkemail?query='+email
                           //dataType: 'json'
                           //contentType:'application/json; charset=utf-8',
                           }).done(function(res, textStatus, xhr) {
                               alert("등록가능한 이메일입니다.");
                               $('#joinuser').attr("disabled",false);

                           }).fail(function (error) {
                              $('#joinuser').attr("disabled",true);
                              alert(error.responseJSON.error.message);
                           });

     });

  });
</script>
</th:block>
</body>
</html>